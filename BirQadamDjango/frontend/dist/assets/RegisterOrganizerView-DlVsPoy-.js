import{a as H}from"./webPortal-BANlqBB7.js";import{d as J,r as p,j,e as K,b as l,w as t,a as r,o as g,h as c,g as v,c as U,l as M,t as Q}from"./index-DHK4OPTE.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"form-section py-12 py-md-16"},Y={class:"d-flex align-center mb-6 ga-4"},Z={class:"d-flex flex-column flex-sm-row ga-4 mt-8"},q=3,ee=J({__name:"RegisterOrganizerView",setup(le){const s=p(1),f=p(null),_=p(null),w=p(null),b=p(!1),m=j({show:!1,color:"success",message:""}),o=j({fullName:"",phoneNumber:"",email:"",password:"",organizationName:"",description:"",city:"",website:"",contactPerson:"",projectsPlan:""}),d={required:n=>!!n||"Поле обязательно для заполнения.",phone:n=>n.replace(/[^0-9+]/g,"").length>=11||"Введите корректный номер телефона.",email:n=>n?/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/.test(n)||"Введите корректный email.":!0,password:n=>n?n.length>=8||"Пароль должен содержать не менее 8 символов.":!0,url:n=>{if(!n)return!0;try{return new URL(n),!0}catch{return"Введите корректный URL."}}},P=(n,e)=>{m.message=n,m.color=e,m.show=!0},C=async()=>{if(s.value===1){const{valid:e}=await f.value?.validate()??{valid:!1};return e}if(s.value===2){const{valid:e}=await _.value?.validate()??{valid:!1};return e}const{valid:n}=await w.value?.validate()??{valid:!1};return n},B=async()=>{await C()&&s.value<q&&(s.value+=1)},R=()=>{s.value>1&&(s.value-=1)},S=()=>{f.value?.reset(),_.value?.reset(),w.value?.reset(),f.value?.resetValidation(),_.value?.resetValidation(),w.value?.resetValidation(),s.value=1},h=async()=>{if(await C()){b.value=!0;try{await H({full_name:o.fullName,phone_number:o.phoneNumber,email:o.email||void 0,password:o.password||void 0,organization_name:o.organizationName,description:o.description,city:o.city,website:o.website||void 0,contact_person:o.contactPerson||o.fullName,notes:o.projectsPlan}),P("Заявка отправлена. Статус: ожидает согласования.","success"),S()}catch(e){const y=e?.response?.data?.detail||"Не удалось отправить заявку. Попробуйте позже.";P(y,"error")}finally{b.value=!1}}};return(n,e)=>{const y=r("v-icon"),O=r("v-avatar"),x=r("v-stepper-item"),E=r("v-stepper-header"),u=r("v-text-field"),i=r("v-col"),V=r("v-row"),k=r("v-form"),N=r("v-stepper-window-item"),F=r("v-textarea"),L=r("v-alert"),T=r("v-stepper-window"),D=r("v-stepper"),z=r("v-btn"),I=r("v-spacer"),$=r("v-card"),A=r("v-container"),G=r("v-snackbar");return g(),K("section",X,[l(A,null,{default:t(()=>[l(V,{class:"justify-center"},{default:t(()=>[l(i,{cols:"12",md:"10",lg:"8"},{default:t(()=>[l($,{class:"pa-6 pa-md-10 elevation-8"},{default:t(()=>[c("div",Y,[l(O,{color:"primary",size:"52"},{default:t(()=>[l(y,{icon:"mdi-account-group-outline",size:"32"})]),_:1}),e[12]||(e[12]=c("div",null,[c("h1",{class:"text-h5 text-md-h4 font-weight-bold mb-1"},"Регистрация организатора"),c("p",{class:"text-body-2 text-medium-emphasis mb-0"}," Расскажите об организации и целях. После модерации вы получите доступ к кабинету организатора. ")],-1))]),l(D,{modelValue:s.value,"onUpdate:modelValue":e[10]||(e[10]=a=>s.value=a),flat:"","alt-labels":""},{default:t(()=>[l(E,null,{default:t(()=>[l(x,{value:1,title:"Контакты"}),l(x,{value:2,title:"Организация"}),l(x,{value:3,title:"Дополнительно"})]),_:1}),l(T,null,{default:t(()=>[l(N,{value:1},{default:t(()=>[l(k,{ref_key:"personalForm",ref:f,class:"mt-6"},{default:t(()=>[l(V,null,{default:t(()=>[l(i,{cols:"12",md:"6"},{default:t(()=>[l(u,{modelValue:o.fullName,"onUpdate:modelValue":e[0]||(e[0]=a=>o.fullName=a),label:"Полное имя",variant:"outlined","prepend-inner-icon":"mdi-account",rules:[d.required],autocomplete:"name"},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(u,{modelValue:o.contactPerson,"onUpdate:modelValue":e[1]||(e[1]=a=>o.contactPerson=a),label:"Контактное лицо (если отличается)",variant:"outlined","prepend-inner-icon":"mdi-account-tie",hint:"Введите имя ответственного за коммуникацию."},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(u,{modelValue:o.phoneNumber,"onUpdate:modelValue":e[2]||(e[2]=a=>o.phoneNumber=a),label:"Номер телефона",variant:"outlined","prepend-inner-icon":"mdi-phone",rules:[d.required,d.phone],autocomplete:"tel"},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(u,{modelValue:o.email,"onUpdate:modelValue":e[3]||(e[3]=a=>o.email=a),label:"Email",variant:"outlined","prepend-inner-icon":"mdi-email-outline",rules:[d.email],autocomplete:"email"},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12"},{default:t(()=>[l(u,{modelValue:o.password,"onUpdate:modelValue":e[4]||(e[4]=a=>o.password=a),label:"Пароль (опционально)",variant:"outlined","prepend-inner-icon":"mdi-lock-outline",rules:[d.password],type:"password",hint:"Если оставить пустым, система сгенерирует пароль автоматически.","persistent-hint":"",autocomplete:"new-password"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(N,{value:2},{default:t(()=>[l(k,{ref_key:"organizationForm",ref:_,class:"mt-6"},{default:t(()=>[l(V,null,{default:t(()=>[l(i,{cols:"12"},{default:t(()=>[l(u,{modelValue:o.organizationName,"onUpdate:modelValue":e[5]||(e[5]=a=>o.organizationName=a),label:"Название организации",variant:"outlined","prepend-inner-icon":"mdi-domain",rules:[d.required]},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12"},{default:t(()=>[l(F,{modelValue:o.description,"onUpdate:modelValue":e[6]||(e[6]=a=>o.description=a),label:"Описание деятельности",variant:"outlined",rows:"4","auto-grow":"","prepend-inner-icon":"mdi-text",rules:[d.required]},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(u,{modelValue:o.city,"onUpdate:modelValue":e[7]||(e[7]=a=>o.city=a),label:"Город",variant:"outlined","prepend-inner-icon":"mdi-map-marker-outline",rules:[d.required]},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(u,{modelValue:o.website,"onUpdate:modelValue":e[8]||(e[8]=a=>o.website=a),label:"Сайт или соцсети",variant:"outlined","prepend-inner-icon":"mdi-web",rules:[d.url],hint:"Например: https://example.kz"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),l(N,{value:3},{default:t(()=>[l(k,{ref_key:"additionalForm",ref:w,class:"mt-6"},{default:t(()=>[l(L,{type:"info",variant:"tonal",border:"start",class:"mb-6",title:"Что происходит дальше"},{default:t(()=>[...e[13]||(e[13]=[v(" После отправки заявки администратор проверит данные и свяжется с вами. Статус будет доступен в личном кабинете. ",-1)])]),_:1}),l(V,null,{default:t(()=>[l(i,{cols:"12"},{default:t(()=>[l(F,{modelValue:o.projectsPlan,"onUpdate:modelValue":e[9]||(e[9]=a=>o.projectsPlan=a),label:"Краткое описание планируемых проектов",variant:"outlined",rows:"4","auto-grow":"",placeholder:"Расскажите, какие мероприятия вы планируете организовывать в ближайшее время."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1},8,["modelValue"]),c("div",Z,[s.value>1?(g(),U(z,{key:0,variant:"outlined",color:"primary",class:"text-none",size:"large",onClick:R},{default:t(()=>[...e[14]||(e[14]=[v(" Назад ",-1)])]),_:1})):M("",!0),l(I,{class:"d-none d-sm-flex"}),s.value<q?(g(),U(z,{key:1,color:"primary",class:"text-none",size:"large",onClick:B},{default:t(()=>[...e[15]||(e[15]=[v(" Далее ",-1)])]),_:1})):(g(),U(z,{key:2,color:"warning",class:"text-none font-weight-bold",size:"large",loading:b.value,onClick:h},{default:t(()=>[...e[16]||(e[16]=[v(" Отправить заявку ",-1)])]),_:1},8,["loading"]))])]),_:1})]),_:1})]),_:1})]),_:1}),l(G,{modelValue:m.show,"onUpdate:modelValue":e[11]||(e[11]=a=>m.show=a),color:m.color,timeout:"4000"},{default:t(()=>[v(Q(m.message),1)]),_:1},8,["modelValue","color"])])}}}),ne=W(ee,[["__scopeId","data-v-b61d7009"]]);export{ne as default};
